"use strict";var TicTacToe=function(){var e=$("#status"),r="",t="",a="",n=null,i=0,s=null,o=[],c=[1,2,3,4,5,6,7,8,9],l=[2,4,6,8],u=[1,3,7,9],m=[[1,2,3],[4,5,6],[7,8,9],[1,4,7],[2,5,8],[3,6,9],[1,5,9],[3,5,7]],k=function(){return{1:{rows:[0,3,6],marker:"-"},2:{rows:[0,4],marker:"-"},3:{rows:[0,5,7],marker:"-"},4:{rows:[1,3],marker:"-"},5:{rows:[1,4,6,7],marker:"-"},6:{rows:[1,5],marker:"-"},7:{rows:[2,3,7],marker:"-"},8:{rows:[2,4],marker:"-"},9:{rows:[2,5,6],marker:"-"}}},h={};return{moveRandomly:function(){var e=c[Math.floor(Math.random()*c.length)];this.markSpace(t,e)},cpuTurn:function(){if("easy"===a)this.moveRandomly();else switch(i){case 1:this.markSpace(t,5);break;case 3:var e=s;if(h[5].marker===t&&this.isEdge(e))switch(e){case 2:this.markSpace(t,7);break;case 4:this.markSpace(t,9);break;case 6:this.markSpace(t,1);break;case 8:this.markSpace(t,3)}if(h[5].marker===t&&this.isCorner(e))switch(e){case 1:this.markSpace(t,9);break;case 3:this.markSpace(t,7);break;case 7:this.markSpace(t,3);break;case 9:this.markSpace(t,1)}break;case 5:this.isEdge(o[1])?this.attemptWin()||this.attemptBlock():this.attemptBlock()||this.attemptTriangle();break;case 7:this.isEdge(o[1])?this.attemptWin()||this.attemptBlock():this.isCorner(o[3])?this.attemptWin()||this.attemptBlock()||this.attemptSetup():this.attemptWin();break;case 9:this.moveRandomly()}},attemptTriangle:function(){for(var e=null,r=0;r<=7;r++)if(e=null,h[m[r][0]].marker===t&&"-"===h[m[r][1]].marker&&"-"===h[m[r][2]].marker&&(e=m[r][2]),"-"===h[m[r][0]].marker&&"-"===h[m[r][1]].marker&&h[m[r][2]].marker===t&&(e=m[r][0]),null!==e)return this.markSpace(t,e),!0;return!1},attemptSetup:function(){for(var e=0,r=0,a=null,n=0;n<=7;n++){e=0,r=0,a=null;for(var i=0;i<=2;i++)h[m[n][i]].marker===t?e++:"-"===h[m[n][i]].marker&&(a=m[n][i],r++);if(1===e&&2===r)return this.markSpace(t,a),!0}return!1},attemptWin:function(){for(var e=0,r=null,a=0;a<=7;a++){e=0,r=null;for(var n=0;n<=2;n++)h[m[a][n]].marker===t?e++:"-"===h[m[a][n]].marker&&(r=m[a][n]);if(2===e&&null!==r)return this.markSpace(t,r),!0}return!1},attemptBlock:function(){for(var e=0,a=null,n=0;n<=7;n++){e=0,a=null;for(var i=0;i<=2;i++)h[m[n][i]].marker===r?e++:"-"===h[m[n][i]].marker&&(a=m[n][i]);if(2===e&null!==a)return this.markSpace(t,a),!0}return!1},isCorner:function(e){return u.indexOf(e)!==-1},isEdge:function(e){return l.indexOf(e)!==-1},checkRow:function(r){var a=m[r],i=h[a[0]].marker,s=h[a[1]].marker,o=h[a[2]].marker;if(i===s&&i===o){i===t?e.text("You lose!"):e.text("You win!");for(var c=0;c<3;c++)$("#space-"+a[c]).find("span").css({color:"#ee6e73"});n=null}},markSpace:function(r,t){console.log("Turn: "+i+" - Space: "+t+" - "+r),i++,s=t,o.push(s),h[t].marker=r,$("#space-"+t).find("span").text(r),c.splice(c.indexOf(t),1);for(var a=h[t].rows,l=0,u=a.length;l<u;l++)this.checkRow(a[l]);"player"===n?(this.disableHover(),n="cpu",0===c.length?(e.text("NOBODY WINS."),n=null):(e.text("Thinking..."),this.cpuTurn())):"cpu"===n?0===c.length?(e.text("NOBODY WINS."),n=null):(this.enableHover(),n="player",e.text("Your turn.")):null===n&&this.disableHover()},enableHover:function(){for(var e=1;e<=9;e++)"-"===h[e].marker&&$("#space-"+e).addClass("space-hover")},disableHover:function(){for(var e=1;e<=9;e++)$("#space-"+e).removeClass("space-hover")},getPlayerMarker:function(){return r},isLegalMove:function(e){return c.indexOf(e)!==-1},canMove:function(){return"player"===n},printCurrentBoard:function(){for(var e="",r=1;r<=9;r++)e+=h[r].marker,r%3===0&&(e+="\n");console.log(e)},newGame:function(l,u,m,f){h=new k,c=[1,2,3,4,5,6,7,8,9],i=1,s=null,o=[],a=l,r=u,t=m;for(var p=1;p<=9;p++)$("#space-"+p).find("span").text(""),$("#space-"+p).find("span").css({color:"#e0f2f1"});console.log("Starting new "+a+" game.\nPlayer:"+r+" CPU:"+t+"\n"+f+" goes first."),"player"===f?(this.enableHover(),n="player",e.text("Your turn.")):(n="cpu",e.text("Thinking..."),this.cpuTurn())}}};$(document).ready(function(){var e=new TicTacToe,r="X",t="O",a="X",n="O",i="easy";e.newGame(i,r,t,"player"),$(".container").on("click",function(){var r=$(this).data("id");e.canMove()&&e.isLegalMove(r)&&e.markSpace(e.getPlayerMarker(),r)}),$(".new-game-btn").on("click",function(){e.newGame(i,a,n,$(this).data("first"))}),$(".marker-btn").on("click",function(){var e=$(this).text();"X"===e?(a="O",n="X",$(this).text("O")):(a="X",n="O",$(this).text("X"))}),$(".difficulty-btn").on("click",function(){"easy"===i?(i="hard",$(this).text("Hard")):(i="easy",$(this).text("Easy"))})});