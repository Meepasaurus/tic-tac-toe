"use strict";var TicTacToe=function(){var e=$("#status"),r="",a="",t="",n=null,i=0,s=null,c=[],o=[1,2,3,4,5,6,7,8,9],l=[2,4,6,8],u=[1,3,7,9],m=[[1,2,3],[4,5,6],[7,8,9],[1,4,7],[2,5,8],[3,6,9],[1,5,9],[3,5,7]],k=function(){return{1:{rows:[0,3,6],marker:"-"},2:{rows:[0,4],marker:"-"},3:{rows:[0,5,7],marker:"-"},4:{rows:[1,3],marker:"-"},5:{rows:[1,4,6,7],marker:"-"},6:{rows:[1,5],marker:"-"},7:{rows:[2,3,7],marker:"-"},8:{rows:[2,4],marker:"-"},9:{rows:[2,5,6],marker:"-"}}},h={};return{moveRandomly:function(){var e=o[Math.floor(Math.random()*o.length)];this.markSpace(a,e)},cpuTurn:function(){if("easy"===t)this.moveRandomly();else switch(i){case 1:this.markSpace(a,5);break;case 2:var e=s;switch(e){case 1:}break;case 3:var r=s;if(h[5].marker===a&&this.isEdge(r))switch(r){case 2:this.markSpace(a,7);break;case 4:this.markSpace(a,9);break;case 6:this.markSpace(a,1);break;case 8:this.markSpace(a,3)}if(h[5].marker===a&&this.isCorner(r))switch(r){case 1:this.markSpace(a,9);break;case 3:this.markSpace(a,7);break;case 7:this.markSpace(a,3);break;case 9:this.markSpace(a,1)}break;case 5:this.isEdge(c[1])?this.attemptWin()||this.attemptBlock():this.attemptBlock()||this.attemptTriangle();break;case 7:this.isEdge(c[1])?this.attemptWin()||this.attemptBlock():this.isCorner(c[3])?this.attemptWin()||this.attemptBlock()||this.attemptSetup():this.attemptWin();break;case 9:this.moveRandomly()}},attemptTriangle:function(){for(var e=null,r=0;r<=7;r++)if(e=null,h[m[r][0]].marker===a&&"-"===h[m[r][1]].marker&&"-"===h[m[r][2]].marker&&(e=m[r][2]),"-"===h[m[r][0]].marker&&"-"===h[m[r][1]].marker&&h[m[r][2]].marker===a&&(e=m[r][0]),null!==e)return this.markSpace(a,e),!0;return!1},attemptSetup:function(){for(var e=0,r=0,t=null,n=0;n<=7;n++){e=0,r=0,t=null;for(var i=0;i<=2;i++)h[m[n][i]].marker===a?e++:"-"===h[m[n][i]].marker&&(t=m[n][i],r++);if(1===e&&2===r)return this.markSpace(a,t),!0}return!1},attemptWin:function(){for(var e=0,r=null,t=0;t<=7;t++){e=0,r=null;for(var n=0;n<=2;n++)h[m[t][n]].marker===a?e++:"-"===h[m[t][n]].marker&&(r=m[t][n]);if(2===e&&null!==r)return this.markSpace(a,r),!0}return!1},attemptBlock:function(){for(var e=0,t=null,n=0;n<=7;n++){e=0,t=null;for(var i=0;i<=2;i++)h[m[n][i]].marker===r?e++:"-"===h[m[n][i]].marker&&(t=m[n][i]);if(2===e&null!==t)return this.markSpace(a,t),!0}return!1},isCorner:function(e){return u.indexOf(e)!==-1},isEdge:function(e){return l.indexOf(e)!==-1},checkRow:function(r){var t=m[r],i=h[t[0]].marker,s=h[t[1]].marker,c=h[t[2]].marker;if(i===s&&i===c){i===a?e.text("You lose!"):e.text("You win!");for(var o=0;o<3;o++)$("#space-"+t[o]).find("span").css({color:"#ee6e73"});n=null}},markSpace:function(r,a){console.log("Turn: "+i+" - Space: "+a+" - "+r),i++,s=a,c.push(s),h[a].marker=r,$("#space-"+a).find("span").text(r),o.splice(o.indexOf(a),1);for(var t=h[a].rows,l=0,u=t.length;l<u;l++)this.checkRow(t[l]);"player"===n?(this.disableHover(),n="cpu",0===o.length?(e.text("NOBODY WINS"),n=null):(e.text("Thinking..."),this.cpuTurn())):"cpu"===n?0===o.length?(e.text("NOBODY WINS"),n=null):(this.enableHover(),n="player",e.text("Your turn")):null===n&&this.disableHover()},enableHover:function(){for(var e=1;e<=9;e++)"-"===h[e].marker&&$("#space-"+e).addClass("space-hover")},disableHover:function(){for(var e=1;e<=9;e++)$("#space-"+e).removeClass("space-hover")},getPlayerMarker:function(){return r},isLegalMove:function(e){return o.indexOf(e)!==-1},canMove:function(){return"player"===n},printCurrentBoard:function(){for(var e="",r=1;r<=9;r++)e+=h[r].marker,r%3===0&&(e+="\n");console.log(e)},newGame:function(l,u,m,f){h=new k,o=[1,2,3,4,5,6,7,8,9],i=1,s=null,c=[],t=l,r=u,a=m;for(var p=1;p<=9;p++)$("#space-"+p).find("span").text(""),$("#space-"+p).find("span").css({color:"#e0f2f1"});console.log("Starting new "+t+" game.\nPlayer:"+r+" CPU:"+a+"\n"+f+" goes first."),"player"===f?(this.enableHover(),n="player",e.text("Your turn")):(this.disableHover(),n="cpu",e.text("Thinking..."),this.cpuTurn())}}};$(document).ready(function(){var e=new TicTacToe,r="X",a="O",t="X",n="O",i="easy";e.newGame(i,r,a,"player"),$(".container").on("click",function(){var r=$(this).data("id");e.canMove()&&e.isLegalMove(r)&&e.markSpace(e.getPlayerMarker(),r)}),$(".new-game-btn").on("click",function(){e.newGame(i,t,n,$(this).data("first"))}),$(".marker-btn").on("click",function(){var e=$(this).text();"X"===e?(t="O",n="X",$(this).text("O")):(t="X",n="O",$(this).text("X"))}),$(".difficulty-btn").on("click",function(){"easy"===i?(i="hard",$(this).text("Hard")):(i="easy",$(this).text("Easy"))})});